<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Yapaa</title>

  <style>
    :root {
      --bg: #0e0e0e;
      --panel: #1a1a1a;
      --soft: #2a2a2a;
      --text: #ffffff;
      --muted: #9a9a9a;
      --radius: 25px;
      --gradient: linear-gradient(to right, #ff914d, #ff6100);
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
    }

    /* NAVBAR */

    .navbar {
      height: 70px;
      background: #111;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 30px;
      border-bottom: 1px solid #222;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 12px;
      font-size: 22px;
      font-weight: bold;
    }

    .logo img {
      height: 40px;
    }

    .nav-right {
      display: flex;
      gap: 10px;
    }

    /* LAYOUT */

    .layout {
      display: flex;
      padding: 20px;
      gap: 20px;
      max-width: 1400px;
      margin: auto;
    }

    .sidebar {
      width: 220px;
      background: var(--panel);
      border-radius: var(--radius);
      padding: 20px;
      height: fit-content;
    }

    .sidebar h3 {
      margin-top: 0;
      font-size: 16px;
      color: var(--muted);
    }

    .feed {
      flex: 1;
      max-width: 650px;
    }

    .rightbar {
      width: 250px;
      background: var(--panel);
      border-radius: var(--radius);
      padding: 20px;
      height: fit-content;
    }

    /* CARDS */

    .card {
      background: var(--panel);
      border-radius: var(--radius);
      padding: 18px;
      margin-bottom: 20px;
    }

    textarea {
      width: 100%;
      height: 80px;
      border: none;
      resize: none;
      border-radius: var(--radius);
      padding: 12px;
      background: var(--soft);
      color: white;
      font-size: 14px;
    }

    .username {
      font-weight: bold;
      margin-bottom: 6px;
    }

    .timestamp {
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 8px;
    }

    /* BUTTONS */

    button {
      padding: 10px 14px;
      border: none;
      border-radius: var(--radius);
      background: #3a3a3a;
      color: white;
      cursor: pointer;
      transition: all 0.25s ease;
    }

    button:hover {
      background: var(--gradient);
    }

    .full-btn {
      width: 100%;
      margin-top: 10px;
    }

    /* RESPONSIVE */

    @media (max-width: 1000px) {
      .sidebar, .rightbar {
        display: none;
      }

      .layout {
        justify-content: center;
      }
    }

  </style>
</head>

<body>

  <!-- NAVBAR -->
  <div class="navbar">
    <div class="logo">
      <img src="YAPAA BETA V1 (3).png" />
      Yapaa
    </div>

    <div class="nav-right">
      <button id="loginBtn">Login</button>
      <button id="logoutBtn">Logout</button>
    </div>
  </div>

  <!-- MAIN LAYOUT -->
  <div class="layout">

    <!-- LEFT SIDEBAR -->
    <div class="sidebar">
      <h3>Navigation</h3>
      <p>Home</p>
      <p>Profile</p>
      <p>My Yaps</p>
    </div>

    <!-- CENTER FEED -->
    <div class="feed">

      <!-- Post Composer -->
      <div class="card">
        <textarea id="yapInput" placeholder="What do you want to yap?"></textarea>
        <button id="postBtn" class="full-btn">Yap</button>
      </div>

      <!-- Feed -->
      <div id="feed"></div>

    </div>

    <!-- RIGHT SIDEBAR -->
    <div class="rightbar">
      <h3>Yapaa Beta</h3>
      <p>Early access build.</p>
      <p>More features coming soon.</p>
    </div>

  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { 
      getAuth, 
      GoogleAuthProvider, 
      signInWithPopup, 
      signOut,
      onAuthStateChanged
    } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

    import { 
      getFirestore, 
      collection, 
      addDoc, 
      serverTimestamp,
      onSnapshot,
      query,
      orderBy
    } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyCAjWjAurT-TTbbo8P70Uo9IA5S6U1EAaM",
      authDomain: "yapaa-5f2b8.firebaseapp.com",
      projectId: "yapaa-5f2b8",
      storageBucket: "yapaa-5f2b8.firebasestorage.app",
      messagingSenderId: "508880150784",
      appId: "1:508880150784:web:42353862a32d9010ac13e5"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    const provider = new GoogleAuthProvider();

    const loginBtn = document.getElementById("loginBtn");
    const logoutBtn = document.getElementById("logoutBtn");
    const postBtn = document.getElementById("postBtn");
    const yapInput = document.getElementById("yapInput");
    const feed = document.getElementById("feed");

    loginBtn.onclick = async () => {
      await signInWithPopup(auth, provider);
    };

    logoutBtn.onclick = async () => {
      await signOut(auth);
    };

    postBtn.onclick = async () => {
      if (!auth.currentUser) {
        alert("Login first.");
        return;
      }

      const text = yapInput.value.trim();
      if (!text) return;

      await addDoc(collection(db, "yaps"), {
        uid: auth.currentUser.uid,
        username: auth.currentUser.email.split("@")[0],
        content: text,
        createdAt: serverTimestamp()
      });

      yapInput.value = "";
    };

    const q = query(collection(db, "yaps"), orderBy("createdAt", "desc"));

    onSnapshot(q, (snapshot) => {
      feed.innerHTML = "";
      snapshot.forEach((doc) => {
        const data = doc.data();

        const yap = document.createElement("div");
        yap.className = "card";

        yap.innerHTML = `
          <div class="username">${data.username}</div>
          <div class="timestamp">${data.createdAt?.toDate().toLocaleString() || ""}</div>
          <div>${data.content}</div>
        `;

        feed.appendChild(yap);
      });
    });
  </script>

</body>
</html>
